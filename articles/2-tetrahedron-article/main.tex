\documentclass [12 pt, a4paper, english,russian]{article}
\usepackage{amsmath, amsfonts, amssymb, graphics, setspace}
\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage{babel,indentfirst,epigraph}
\usepackage{graphics}
\usepackage[dvips]{graphicx}
\numberwithin{equation}{section}

\overfullrule5pt


\begin{document}

\vskip 0.3cm

\begin{center}
{\Large \textbf {Об определении координат и пространственной ориентации воздушных объектов с помощью фазированных антенных решеток}}
\newline

{\textbf { Виноградов А.Д., Минин Л.А., Морозов Е.Ю., Ушаков С.Н.}}
\end{center}

\section {Постановка задачи}

Решается следующая задача. На поверхности Земли расположены источники электромагнитного излучения. Объект, находящийся в воздухе, принимает сигналы от источников и определяет направление на них. Система координат, в которой проводятся измерения, жестко связана с объектом и характеризуется тремя величинами -- углами Эйлера -- которые неизвестны. Также неизвестны и координаты объекта. Всего получается шесть величин, требующих определения. Количество источников и их координаты заданы. Выбор оптимального числа источников и их взаимного расположения также входит в постановку задачи.

От одного источника можно измерить два угла: азимут и угол возвышения. Поэтому должно быть не менее трех источников.  В данной работе предлагается разбить решение общей задачи на четыре этапа:\\
1) нахождение расстояний от объекта до источников;\\
2) определение областей, в которых решение единственно;\\
3) нахождение координат воздушного объекта;\\
4) определение  матрицы поворота и связанных с нею углов Эйлера.

Система уравнений, возникающая на первом этапе, оказывается нелинейной. В случае трех источников это приводит к неоднозначности решений, число которых может быть от одного до четырех. При большем числе источников, с учетом погрешности измерений, система уравнений перестает быть совместной. Если применить для ее решения стандартный метод наименьших квадратов, то уравнения из квадратных становятся кубическими, что сильно усложняет задачу. Поэтому в данной работе проводится математическое исследование двух случаев: трех источников и четырех источников, когда три из них лежат на одной прямой. В первом случае предложен устойчивый приближенный метод решения, позволяющий  отсечь лишние решения, во втором случае выписаны явные формулы для нахождения расстояний от объекта до источников.

Задачи третьего и четвертого этапов являются стандартными для навигации движущихся объектов, поэтому не требуется разрабатывать специальных методов для их решения. Ключевой оказывается именно первая задача определения расстояний. Несмотря на внешнюю простоту системы трех квадратных уравнений относительно искомых расстояний, структура решений оказывается сложной, включая большое число вырожденных случаев, когда меняется количество решений. Без понимания данных особенностей сложно строить эффективные алгоритмы решения.


\section {Cлучай трех источников}

Пусть источники излучения находятся в точках $M_1,M_2,M_3$ с заданными координатами $M_i(x_i,y_i,z_i), \; i=1,2,3$, а воздушный объект -- в точке $M_0$ с неизвестными координатами $M_0(x,y,z)$. Указанные четыре точки образуют треугольную пирамиду (рис. \ref {ris:M123}).
Введем следующие обозначения:\\
$\ell_i$ -- длина бокового ребра пирамиды $M_iM_0$;\\
$d_{ij}$ -- длина основания пирамиды $M_iM_j$;\\
$\alpha_{ij}=\angle M_i M_0 M_j$ -- плоский угол при вершине пирамиды,\\
$\mathbf{r}_i=(x_i,y_i,z_i)$ -- радиус-вектор точки $M_i, \; i=0,1,2,3.$

\begin{figure}[h]
\center{\includegraphics[bb=0 0 1600 1600,
viewport=1 1 1600 1600, clip=true,
scale=0.18]{pic1.png}}
\caption{Треугольная пирамида.}
\label {ris:M123}
\end{figure}

Тогда для нахождения $\ell_i$ получим систему трех уравнений с тремя неизвестными
\begin {equation}
 \left\{
  \begin {matrix}
   \ell_1^2+\ell_2^2-2 \ell_1 \ell_2 \cos \alpha_{12} = d_{12}^2 \\
   \ell_1^2+\ell_3^2-2 \ell_1 \ell_3 \cos \alpha_{13} = d_{13}^2 \\
   \ell_2^2+\ell_3^2-2 \ell_2 \ell_3 \cos \alpha_{23} = d_{23}^2
  \end {matrix}\right.
  \label {ell_123}
\end {equation}

Как показали вычислительные эксперименты, данная система может иметь от одного до четырех решений. Предположим, величины $\ell_1,\ell_2,\ell_3$ найдены. Для неизвестных координат точки $M_0(x,y,z)$ получается система трех уравнений
\begin {equation}
 \left\{
  \begin {matrix}
   (x-x_1)^2+(y-y_1)^2+(z-z_1)^2=\ell_1^2 \\
   (x-x_2)^2+(y-y_2)^2+(z-z_2)^2=\ell_2^2 \\
   (x-x_3)^2+(y-y_3)^2+(z-z_3)^2=\ell_3^2
  \end {matrix}\right.
  \label {xyz}
\end {equation}
Вычтем из второго и третьего уравнений \eqref{xyz} первое уравнение:
\begin {equation}
 \left\{
  \begin {matrix}
   2x(x_1-x_2)+2y(y_1-y_2)+2z(z_1-z_2)=\\
   =\ell_2^2 - \ell_1^2+ x_1^2-x_2^2 + y_1^2-y_2^2 + z_1^2-z_2^2\\
   2x(x_1-x_3)+2y(y_1-y_3)+2z(z_1-z_3)=\\
   =\ell_3^2 - \ell_1^2+ x_1^2-x_3^2 + y_1^2-y_3^2 + z_1^2-z_3^2
  \end {matrix}\right.
  \label {xyz_2}
\end {equation}
Выразив $x,y$ через $z$ из системы \eqref {xyz_2}, подставим полученные выражения в первое уравнение \eqref {xyz}. Получим для $z$ квадратное уравнение. Определитель системы \eqref {xyz_2} относительно переменных $x,y$ не равен нулю, так как точки $M_1,M_2,M_3$ не лежат на одной прямой.

После нахождения координат точки $M_0$ построим три вектора единичной длины в исходной системе координат
$$  \mathbf{e}_i = \frac {\mathbf{r}_0 - \mathbf{r}_i} {|\mathbf{r}_0 - \mathbf{r}_i|}, \; i=1,2,3,
$$
и обозначим через $E$ матрицу, составленную из координат этих векторов, записанных в столбцы.
Для тех же самых векторов в системе координат, связанной с воздушным объектом,
$$ \mathbf{e_i}', \; i=1,2,3,
$$
зададим матрицу $E'$. Тогда матрица перехода $T$ из одной системы координат в другую задается  матричным равенством
$$ T^*=E' E^{-1},
$$
где $T^*$ -- транспонированная к $T$ матрица. Углы Эйлера из матрицы перехода находятся стандартным образом.

Таким образом, ключевой является именно задача нахождения расстояний от объекта до источником. Две остальные задачи -- нахождение координат и углов поворота -- решаются совершенно стандартными средствами.

\section {Математические особенности решения системы}

Несмотря на внешнюю простоту системы \eqref {ell_123}, она имеет массу особенностей, описание всех ее решений для разных случаев расположения источников и воздушного объекта требует обширного математического исследования. С прикладной точки зрения более практичным выглядит следующий подход: использовать приближенный метод решения, а при его разработке учитывать структуру возможных решений, полученную с помощью качественных рассуждений. Без понимания такой структуры гораздо сложнее строить эффективные методы, позволяющие контролировать погрешности промежуточных вычислений.

Систему \eqref{ell_123} можно свести, вообще говоря, к уравнению четвёртой степени относительно одной переменной. Прежде чем показать, как это делается, опишем некоторые свойства решений исходной системы.

Во-первых, если $(\ell_1, \ell_2, \ell_3)$ --- решение, то $(-\ell_1, -\ell_2, -\ell_3)$ -- тоже решение.  Кроме того, хотя решение с отрицательными значениями ребер не физично, оно  оказывается связанным с аналогичной задачей с теми же точками $M_1$, $M_2$, $M_3$, но с набором углов, дающих те же значения по модулю косинусов. Например, если $(-\ell_1, \ell_2, \ell_3)$ -- одно из решений для набора углов $(\alpha_{12}, \alpha_{13}, \alpha_{23})$, то $(\ell_1, \ell_2, \ell_3)$ -- для $(\pi-\alpha_{12}, \pi-\alpha_{13}, \alpha_{23})$.

Во-вторых, если считать все возможные решения, в том числе и с нулевыми и отрицательными рёбрами, то их получится не больше восьми. С учетом описанной выше симметрии число положительных решений не больше четырёх.

В-третьих, каждое конкретное решение $(\ell_1, \ell_2, \ell_3)$ непрерывно зависит от набора углов $(\alpha_{12}, \alpha_{13}, \alpha_{23} )$.

В-четвёртых, систему \eqref{ell_123} можно интерпретировать следующим образом. В каждой из боковых гранях нам известна сторона и угол лежащий напротив неё. Следовательно, нам известен радиус описанной окружности около боковой грани. Обозначим длину этой стороны через $d$, а радиус окружности описанной около грани через $R_d$. Искомая точка может располагаться в  зависимости от угла (острый или тупой)  на меньшей или большей дуге этой окружности соответственно. Эта окружность не единственная и образует семейство. Его можно описать как множество точек равноудаленных на расстояние $R_d$ от окружности с центром в середине стороны и радиусом равным $\sqrt{R_d^2-\frac{d^2}{4}}$. Эта конструкция похожа на тор, но её отличие в том, что  радиус окружности меньше расстояния, на которое равноудалены точки. Это $"$тор$"$   без дырки, $"$тор$"$ с внешними границами, оказавшимися внутри (рис. \ref{ris:tor}).


\begin{figure}[h]
\center{\includegraphics[bb=0 0 1600 1600,
viewport=1 1 1600 1600, clip=true,
scale=0.2]{pic2.png}}
\caption{Тор без дырки.}
\label {ris:tor}
\end{figure}


В-пятых, исходя из геометрии задачи  можно утверждать, что если каждый угол боковой грани больше соответствующего ему угла треугольника основания (углы должны опираться на одну и ту же сторону), решение единственно и его проекция на плоскость $M_1 M_2 M_3$ находится внутри треугольника $ M_1 M_2 M_3$. В тот момент, когда плоский угол при вершине пирамиды совпадает с соответствующем ему углом треугольника основания, возникает решение с нулевым ребром.  Далее, при уменьшении плоского угла (например, при вертикальном подъеме воздушного объекта) в силу непрерывности оно переходит в решение со всеми положительными боковыми ребрами.

Трудности и особенности, относящиеся к получению аналитического решения,  будут продемонстрированы на основе частного случая, когда в основании находится равносторонний треугольник. Заметим, что используемые при этом приемы в целом применимы и для общего случая. Система \eqref{ell_123} примет следующий вид:

\begin {equation}
\left\{
\begin {matrix}
\ell_1^2+\ell_2^2-2 \ell_1 \ell_2 \cos \alpha_{12} = a^2 \\
\ell_1^2+\ell_3^2-2 \ell_1 \ell_3 \cos \alpha_{13} = a^2 \\
\ell_2^2+\ell_3^2-2 \ell_2 \ell_3 \cos \alpha_{23} = a^2
\end {matrix}\right.
\label {ell_1}
\end {equation}
Если в этой системе сделать замену $\ell_2= t \ell_1$, $\ell_3= s \ell_1$ (случай $\ell_1=0$ следует рассмотреть отдельно), то перейдём к системе
\begin {equation}
\left\{
\begin {matrix}
\ell_1^2(1-2 t \cos \alpha_{12} + t^2) = a^2 \\
\ell_1^2(1-2 s \cos \alpha_{13} + s^2) = a^2 \\
\ell_1^2(s^2-2 s t \cos \alpha_{23} + t^2) = a^2
\end {matrix}\right.
\label {ell_2}
\end {equation}
Теперь разделим первое уравнение на второе. Также из суммы первого и второго вычтем третье и результат поделим на первое. Получим,
\begin {equation}
\left\{
\begin {matrix}
t^2-2 t \cos \alpha_{12}  =  s^2-2 s \cos \alpha_{13}  \\
2 s (t \cos \alpha_{23} - \cos \alpha_{13} ) = t^2-1.
\end {matrix}\right.
\label {ell_3}
\end {equation}
Из второго уравнения выразим $s$ и подставим в первое (случай $t=\pm 1$ требует отдельного рассмотрения):

\begin {equation}
\begin {array}{l}
(1-4 \cos^2 \alpha_{23}) t^4 + 4 \cos \alpha_{23} (\cos \alpha_{23} + 2 \cos \alpha_{12} \cos \alpha_{23} ) t^3 - \\
- 2 (1 + 8 \cos \alpha_{12} \cos \alpha_{13} \cos \alpha_{23}) t^2 +
\\+ 4 \cos \alpha_{13} (\cos \alpha_{23} + 2 \cos \alpha_{12} \cos \alpha_{13}) t + 1-4 \cos^2 \alpha_{13} =0
\end {array}
\label {ell_eq_4}
\end {equation}
Для данного уравнения значение $\cos \alpha_{23}= \frac{1}{2}$ является особым. При таких значениях угла $\alpha_{23}$ уравнение 4-ой степени превращается в уравнение 3-ей степени. Кроме того, значение корня $t=\pm 1$ приводит к частным случаям. Эти обстоятельства не позволяют, вообще говоря, использовать уравнение \eqref{ell_eq_4}   для численного решения исходной системы.

\section {Решение системы методом Ньютона}

Вернемся к системе уравнений \eqref {ell_123}. Его можно свести к одному уравнению четвертого порядка, но с практической точки зрения это не самое оптимальное решение.
Более удобным представляется применение приближенного метода решения -- метода Ньютона для нелинейных систем. Мы исходим из того предположения, что начальные условия для применения метода Ньютона нам известны, поскольку мы совершаем постоянный мониторинг воздушного объекта. Решение системы, вообще говоря, не единственно. Но паразитные решения в рабочем режиме полета достаточно удалены от реального. Поэтому метод Ньютона сходится именно к интересующему нас решению. Для получения требуемой точности достаточно сделать 5-6 итераций, причем обратная матрица выписывается явно и нет никаких других операций над числами, кроме арифметических (значения $\cos \alpha_{ij}$
вычисляются один раз после измерения данных углов).
Выпишем систему \eqref {ell_123} в векторной форме
\begin{equation}
  \mathbf{F} (\mathbf{L})=
  \left(
    \begin{array}{c}
      \ell_1^2+\ell_2^2-2 \ell_1 \ell_2 \cos \alpha_{12} - d_{12}^2 \\
      \ell_1^2+\ell_3^2-2 \ell_1 \ell_3 \cos \alpha_{13} - d_{13}^2 \\
      \ell_2^2+\ell_3^2-2 \ell_2 \ell_3 \cos \alpha_{23} - d_{23}^2
    \end{array}
  \right)
  =\mathbf{0}.
\label {ell_123_vector}
\end{equation}
Здесь $\mathbf{L}=(\ell_1,\ell_2,\ell_3)$, а координаты вектора $\mathbf{F}=(F_1,F_2,F_3)$ задаются в соответствии с \eqref {ell_123_vector}. Обозначим через  $DF$ матрицу из частных производных $\frac {\partial F_i} {\partial \ell_j}$,
\begin{equation}
DF=
\left(
  \begin{array}{ccc}
    2\ell_1 - 2\ell_2 \cos \alpha_{12} & 2\ell_2 - 2\ell_1 \cos \alpha_{12} & 0  \\
    2\ell_1 - 2\ell_3 \cos \alpha_{13} & 0 & 2\ell_3 - 2\ell_1 \cos \alpha_{13}  \\
    0 & 2\ell_2 - 2\ell_3 \cos \alpha_{23} & 2\ell_3 - 2\ell_2 \cos \alpha_{23}  \\
  \end{array}
\right),
\label {DF}
\end{equation}
а через $\mathbf{L}^m$ -- $m$-ую итерацию метода Ньютона. Тогда
\begin{equation}
  \mathbf{L}^{m+1}=\mathbf{L}^{m} - (DF)^{-1} \mathbf{F}(\mathbf{L}^{m}).
\label {Newton_vector}
\end{equation}

Обратная матрица $(DF)^{-1}$ легко выписывается в явном виде. Введем следующие обозначения:
\begin {equation}
  \begin {matrix}
   a= 2\ell_1 - 2\ell_2 \cos \alpha_{12}, \; b= 2\ell_2 - 2\ell_1 \cos \alpha_{12}, \\
   c= 2\ell_1 - 2\ell_3 \cos \alpha_{13}, \; d= 2\ell_3 - 2\ell_1 \cos \alpha_{13}, \\
   e= 2\ell_2 - 2\ell_3 \cos \alpha_{23}, \; f= 2\ell_3 - 2\ell_2 \cos \alpha_{23}. \\
  \end {matrix}
  \label {abc}
\end {equation}
Тогда справедлива формула
\begin{equation}
  (DF)^{-1} = \frac {-1} {ade+bcf}
  \left(
    \begin{array}{ccc}
      -de & -bf & bd \\
      -cf &  af & -ad \\
      ce  &\ -ae & -bc
    \end{array}
  \right) .
\label {DF_m1}
\end{equation}

Если рассмотреть процедуру вертикального подъема воздушного объекта из точки, расположенной внутри треугольника $M_1 M_2 M_3$, то выстраивается следующая картина. На малых высотах решение системы единственно, далее появляется второе решение в одной из вершин треугольника и также движется вверх. Проекция полученного решения на плоскость треугольника начинает удаляться от вершины наружу. При достижении следующей критической высоты появляется второе паразитное решение, оно также движется вверх и проекция удаляется от треугольника. Затем появляется и третье паразитное решение. При определенных симметриях паразитные решения могут появляться парой или даже тройкой. Это зависит от конфигурации треугольника, лежащего в основании, и траектории подъема воздушного объекта.

В принципе, допустим случай, когда проекция воздушного объекта изначально выходит за границы треугольника. Структура паразитных решений, соответственно, также перестраивается. Здесь сложно ответить на вопрос, возможно ли полное описание для всех возможных случаев. Гораздо проще провести расчеты по описанной выше методике для заданной конфигурации источников и возможных траекториях подъема и маневрирования воздушного объекта. Сюда же следует отнести и анализ погрешностей, который несложно осуществить стандартными средствами. Дело в том, что у нас есть возможность для любого набора входных данных найти единственное решение и рассчитать среднеквадратичные отклонения, генерируя погрешности по заданной статистической закономерности.

\section {Случай дополнительной точки на ребре основания}

Одним из способов борьбы с неединственностью решения системы \eqref{ell_123} является использование дополнительных  данных. Введение четвертого источника в произвольном положении приводит к переопределенной системе. Фактически, вместо одного треугольника в основании появляется четыре треугольника. То есть, можно решать от двух до четырех систем с тремя источниками и выбрать совместные решения.  С учётом погрешностей измерения этот вариант требует отдельного глубокого исследования.

Однако, если дополнительная точка будет расположена на одном из ребер основания, то исходная задача значительно упрощается. Решение становится единственным и выписывается явно. Будем считать, что точка $M_4$ располагается на ребре $M_1M_2$ (рис. \ref {ris:M1234}).
\begin{figure}[h]
\center{\includegraphics[bb=0 0 1600 1600,
viewport=1 1 1600 1600, clip=true,
scale=0.15]{pic3.png}}
\caption{Случай дополнительной точки.}
\label {ris:M1234}
\end{figure}
Введём обозначения:
\begin{equation*}
\begin{array}{c}
d_{14} = M_1M_4,~d_{24} = M_2M_4,~  \alpha_{14} = \angle M_1M_0M_4,\\
  \alpha_{24} = \angle M_2M_0M_4,~ \varphi= \angle M_0M_4M_1.
\end{array}
\label{d_angle}
\end{equation*}
Так как $\sin ( \pi - \varphi) = \sin \varphi $, то из треугольников $M_0  M_4 M_1$ и $M_0  M_4 M_2$ по теореме синусов получим равенства
\begin{equation*}
  \frac{d_{14}}{\sin \alpha_{14}}=\frac{\ell_1}{\sin \varphi}, \;
  \frac{d_{24}}{\sin \alpha_{24}}=\frac{\ell_2}{\sin \varphi}.
\label{sin_104204}
\end{equation*}
Отсюда,
\begin{equation*}
\frac{\ell_1 \cdot \sin \alpha_{14}}{d_{14}}=\frac{\ell_2 \cdot \sin \alpha_{24}}{d_{24}}=\sin \varphi.
\end{equation*}
Обозначим
\begin{equation*}
k= \frac{d_{24} \sin \alpha_{14}}{d_{14} \sin \alpha_{24}}.
\label{k}
\end{equation*}
Тогда $\ell_2=k \ell_1$.
Осталось записать теорему косинусов для треугольника $M_1 M_0 M_2$:
\begin{equation*}
\ell_1^2 - 2 \ell_1 \ell_2 \cos \alpha_{12} +  \ell_2^2= d_{12}^2.
\label{cos_102}
\end{equation*}
Подставим соотношение $\ell_2=k \ell_1$ в последнее равенство
\begin{equation*}
\ell_1^2(1 - 2 k \cos \alpha_{12} +  k^2)= d_{12}^2.
\label{kcos_102}
\end{equation*}
Теперь рёбра $\ell_1$ и $\ell_2$ находятся по формулам
\begin{equation}
\ell_1 = \frac{d_{12}}{\sqrt{1 - 2 k \cos \alpha_{12} +  k^2}},~\ell_2=k \ell_1,~k= \frac{d_{24} \sin \alpha_{14}}{d_{14} \sin \alpha_{24}}.
\label {L1_L2}
\end{equation}
Для нахождения $\ell_3$ в системе \eqref{ell_123} из второго уравнения вычтем первое. Получим
\begin{equation*}
\ell_3 = \frac{d_{13}^2-d_{23}^2-\ell_1^2-\ell_2^2} {2 (\ell_1\cos \alpha_{13} + \ell_2\cos \alpha_{23})}.
\label {L3}
\end{equation*}



\section {Обсуждение результатов}

Существование решения при погрешностях

Отказ от метода наименьших квадратов

Наклонное положение источников

Наличие дополнительной информации -- высоты объекта.

Расчет зон устойчивости для конкретных конфигураций.

Возможность выхода проекции воздушного объекта за границы треугольника.


\end{document}


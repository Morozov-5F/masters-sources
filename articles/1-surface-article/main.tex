\documentclass [12 pt, a4paper, english,russian]{article}
\usepackage{amsmath, amsfonts, amssymb, graphics, setspace}
\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage{babel,indentfirst,epigraph}
\numberwithin{equation}{section}

\overfullrule5pt


\begin{document}

\vskip 0.3cm

\begin{center}
{\Large \textbf {О разделении основного и отраженного сигналов на трехэлементной вертикальной решетке}}
\newline

{\textbf { Виноградов А.Д., Минин Л.А., Морозов Е.Ю.}}
\end{center}

\section {Постановка задачи}

Рассматривается трехэлементная вертикальная система датчиков с расстоянием $\triangle h$ между соседними элементами. Предполагается, что принимаемый сигнал формируется как суперпозиция двух плоских электромагнитных волн одинаковой частоты. Первая из них, приходящая от регистрируемого источника, имеет амплитуду $E_0$ и фазу на среднем элементе $\varphi _0$. Вторая представляет отраженную от поверхности Земли волну с амплитудой $E_1$ и фазой на среднем элементе $\varphi _1$.
Соответствующие комплексные компоненты принимаемого сигнала задаются формулами
$$\dot{E}_0=E_0 e^{i\varphi _0}, \; \dot{E}_1=E_1 e^{i\varphi _1}.
$$

Пусть $\beta_0$ -- угол отклонения волны источника от горизонта (считаем, что источник находится выше датчиков), $\beta_1$ -- угол отклонения отраженной волны от горизонта (отражение происходит ниже датчиков), $\lambda$ -- длина волны приходящего сигнала. Введем следующие обозначения:
\begin {equation}
  \omega_0= \frac {2 \pi} {\lambda} \triangle h \sin \beta_0, \;
  \omega_1= \frac {2 \pi} {\lambda} \triangle h \sin \beta_1.
  \label {w_0_w_1}
\end {equation}
Тогда для комплексных сигналов $\dot{z}_0, \dot{z}_{\hbox{н}}, \dot{z}_{\hbox{в}}$, регистрируемых на среднем, нижнем и верхнем датчиках, соответственно, справедливы следующие соотношения
\begin {equation}
 \left\{
  \begin {matrix}
   \dot{z}_0=\dot{E}_0+\dot{E}_1 \\
   \dot{z}_{\hbox{н}}=\dot{E}_0 e^{-i\omega_0}+\dot{E}_1 e^{i\omega_1} \\
   \dot{z}_{\hbox{в}}=\dot{E}_0 e^{i\omega_0}+\dot{E}_1 e^{-i\omega_1}
  \end {matrix}\right.
  \label {0_down_up}
\end {equation}
Требуется по заданным величинам $\dot{z}_0, \dot{z}_{\hbox{н}}, \dot{z}_{\hbox{в}}$ определить угол $\beta_0$.

Система \eqref {0_down_up} содержит три комплексных уравнения относительно шести неизвестных вещественных величин $\beta_0,\beta_1,E_0,E_1,\varphi_0,\varphi_1$ и является нелинейной. Выбор данной модели обусловлен тем, что удается аналитически исключить из этой системы все переменные кроме $\omega_0$, которая включает, согласно \eqref {w_0_w_1}, интересующую нас величину $\beta_0$.

\section {Решение системы}

Для исключения $\dot{E}_0$ умножим второе уравнение \eqref {0_down_up} на $e^{i\omega_0}$,  третье уравнение -- на $e^{-i\omega_0}$. Тогда
\begin {equation*}
 \left\{
  \begin {matrix}
   \dot{z}_0=\dot{E}_0+\dot{E}_1 \\
   \dot{z}_{\hbox{н}}e^{i\omega_0}=\dot{E}_0 +\dot{E}_1 e^{i(\omega_1+\omega_0)} \\
   \dot{z}_{\hbox{в}}e^{-i\omega_0}=\dot{E}_0+\dot{E}_1 e^{-i(\omega_1+\omega_0)}
  \end {matrix}\right.
\end {equation*}
Вычитая первое уравнение полученной системы из второго и третьего уравнений, приходим к системе двух комплексных уравнений
\begin {equation*}
 \left\{
  \begin {matrix}
   \dot{z}_{\hbox{н}}e^{i\omega_0} -  \dot{z}_0 = \dot{E}_1 (e^{i(\omega_1+\omega_0)}-1) \\
   \dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0 = \dot{E}_1 (e^{-i(\omega_1+\omega_0)}-1)
  \end {matrix}\right.
\end {equation*}
Для исключения $\dot{E}_1$ домножим второе уравнение на $e^{i(\omega_1+\omega_0)}$ и сложим с первым
\begin {equation*}
   \dot{z}_{\hbox{н}}e^{i\omega_0} -  \dot{z}_0 +
   (\dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0)e^{i(\omega_1+\omega_0)} = 0.
\end {equation*}
Таким образом,
\begin {equation*}
   \dot{z}_{\hbox{н}}e^{i\omega_0} -  \dot{z}_0 =
   -(\dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0) e^{i(\omega_1+\omega_0)}.
\end {equation*}
Осталось исключить $\omega_1$, для чего достаточно взять модуль от левой и правой частей последнего равенства
\begin {equation}
   |\dot{z}_{\hbox{н}}e^{i\omega_0} - \dot{z}_0| = |\dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0|.
   \label {w_0}
\end {equation}
Аналогичное соотношение получается и для $\omega_1$:
\begin {equation}
   |\dot{z}_{\hbox{н}}e^{-i\omega_1} - \dot{z}_0| = |\dot{z}_{\hbox{в}}e^{i\omega_1} - \dot{z}_0|.
   \label {w_1}
\end {equation}

\section {Анализ разрешимости уравнения относительно $\beta_0$}

Запишем уравнение \eqref {w_0} в следующем виде
\begin {equation*}
   |\dot{z}_{\hbox{н}}e^{i\omega_0} -  \dot{z}_0 |^2 =
   |\dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0 |^2.
\end {equation*}
Воспользовавшись тем, что $|\dot{z}|^2=\dot{z} \dot{z}^*$,  где $\dot{z}^*$ означает комплексное сопряжение, придем к равенству
\begin {equation*}
   (\dot{z}_{\hbox{н}}e^{i\omega_0} -  \dot{z}_0 )
   (\dot{z}_{\hbox{н}}e^{i\omega_0} -  \dot{z}_0 )^* =
   (\dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0 )
   (\dot{z}_{\hbox{в}}e^{-i\omega_0} - \dot{z}_0 )^*.
\end {equation*}
Раскрывая скобки, получим
\begin {equation*}
   |\dot{z}_{\hbox{н}}|^2 - \dot{z}_{\hbox{н}} \dot{z}_{0}^*e^{i\omega_0}
    - \dot{z}_{\hbox{н}}^* \dot{z}_{0}e^{-i\omega_0} + |\dot{z}_{0}|^2=
\end {equation*}
\begin {equation*}
   = |\dot{z}_{\hbox{в}}|^2 - \dot{z}_{\hbox{в}} \dot{z}_{0}^*e^{-i\omega_0}
    - \dot{z}_{\hbox{в}}^* \dot{z}_{0}e^{i\omega_0} + |\dot{z}_{0}|^2.
\end {equation*}
Перегруппируем слагаемые:
\begin {equation*}
    (\dot{z}_{\hbox{в}}^* \dot{z}_{0} - \dot{z}_{\hbox{н}} \dot{z}_{0}^* ) e^{i\omega_0} +
    (\dot{z}_{\hbox{в}} \dot{z}_{0}^* - \dot{z}_{\hbox{н}}^* \dot{z}_{0} ) e^{-i\omega_0}  = |\dot{z}_{\hbox{в}}|^2 - |\dot{z}_{\hbox{н}}|^2.
\end {equation*}
Обозначим
\begin {equation}
    \dot{z}_{\hbox{в}}^* \dot{z}_{0} - \dot{z}_{\hbox{н}} \dot{z}_{0}^* = u - iv.
  \label {u_v}
\end {equation}
Тогда $ \dot{z}_{\hbox{в}} \dot{z}_{0}^* - \dot{z}_{\hbox{н}}^* \dot{z}_{0} = u + iv$,
\begin {equation*}
    (u-iv)(\cos {\omega_0}+i\sin {\omega_0}) + (u+iv)(\cos {\omega_0}-i\sin {\omega_0}) = |\dot{z}_{\hbox{в}}|^2 - |\dot{z}_{\hbox{н}}|^2.
\end {equation*}
Соответственно,
\begin {equation}
    u \cos \omega_0 + v \sin \omega_0 =
    \frac {|\dot{z}_{\hbox{в}}|^2 - |\dot{z}_{\hbox{н}}|^2} {2}=c.
  \label {u_v_omega_0}
\end {equation}

Условие разрешимости уравнения \eqref {u_v_omega_0} может быть записано в следующем виде
\begin {equation}
    u^2+v^2\geq c^2.
  \label {c_good}
\end {equation}
Для решения \eqref {u_v_omega_0} перейдем к половинному углу
\begin {equation*}
    u \left (\cos^2 \frac {\omega_0} {2} - \sin^2 \frac {\omega_0} {2} \right ) + 2v \sin \frac {\omega_0} {2} \cos \frac {\omega_0} {2}  = c \left (\cos^2 \frac {\omega_0} {2} + \sin^2 \frac {\omega_0} {2} \right)
\end {equation*}
и перегруппируем слагаемые
\begin {equation*}
    (u-c) \cos^2 \frac {\omega_0} {2}  + 2v \sin \frac {\omega_0} {2} \cos \frac {\omega_0} {2}  - (u+c) \sin^2 \frac {\omega_0} {2} = 0.
\end {equation*}
Если $|u-c|>|u+c|$, то делим данное уравнение на $\sin^2 \frac {\omega_0} {2}$, в противном случае делим на $\cos^2 \frac {\omega_0} {2}$. В первом случае получается квадратное уравнение  относительно $ctg \frac {\omega_0} {2}$:
\begin {equation*}
    (u-c) \ctg^2 \frac {\omega_0} {2}  + 2v \ctg \frac {\omega_0} {2}  - (u+c) = 0,
\end {equation*}
во втором случае -- относительно $tg \frac {\omega_0} {2}$: 
\begin {equation*}
    (u+c) \tg^2 \frac {\omega_0} {2}  - 2v \tg \frac {\omega_0} {2}  - (u-c) = 0.
\end {equation*}
Дискриминант для обоих уравнений равен $4(u^2+v^2-c^2)$  и в силу \eqref {c_good} неотрицателен.

Поскольку $\beta_0>0^o$, то и $\omega_0>0$, а из ограничений сверху на параметры рассматриваемой модели $\beta_0 \leq 15^o$ и $ \frac {\triangle h} {\lambda}  \leq 3.5$ следует, что $\omega_0 < 2\pi $. Соответственно, $0<\omega_0/2<\pi$. Пусть, например, $t_1,t_2$ -- корни квадратного уравнения относительно $tg \frac {\omega_0} {2}$. Если оба корня положительные, то выбираем меньший из них $t_1$. Тогда
$$
  \omega_0=2 arctg t_1, \; \beta_0=\arcsin \frac {\omega_0 \lambda} {2\pi \triangle h}.  
$$
Если корни разных знаков, то выбираем положительный. Если оба корня отрицательные, то выбираем больший по модулю $t_1$  и полагаем $\omega_0=2(arctg t_1 + \pi)$. В случае кратного корня делаем то же самое, только не требуется выбирать один из двух корней. 
Несколько проще случай уравнения относительно $ctg \frac {\omega_0} {2}$. Из двух возможных значений корней выбирается больший.

Возможен и численный метод решения уравнения \eqref {u_v_omega_0}, например, метод половинного деления. В качестве начального отрезка для $\beta_0$ выбирается отрезок $[0^o,15^o]$, для середины отрезка вычисляется  $\omega_0$ по формуле \eqref {w_0_w_1} и отрезок сужается вдвое. Количество итераций определяется поставленной точностью вычислений. Подводя итог, можно сказать, что для решения исходной задачи определения угла $\beta_0$ надо по заданным входным данным $\dot{z}_{\hbox{в}}, \dot{z}_{0}, \dot{z}_{\hbox{н}} $ определить согласно формуле \eqref {u_v} вспомогательные величины $u,v$ и решить аналитически или численно тригонометрическое уравнение \eqref {u_v_omega_0}.


\section {Статистический анализ погрешности}

Наличие явного метода решения системы \eqref {0_down_up} существенно облегчает анализ погрешности.
Стандартным образом возмущаются входные данные $\dot{z}_0,\dot{z}_{\hbox{н}},\dot{z}_{\hbox{в}}
$ с заданным уровнем шума, решается полученная система и вычисляется средне-квадратичная ошибка.

Главное отличие от модели, предложенной в \cite {WGMNP}, состоит в том, что система содержит шесть неизвестных вещественных переменных, а не пять, и поэтому не является переопределенной. Соответственно, нет областей изменения параметров, в которых система несовместна. Сложности, как и следовало ожидать, начинаются при стремлении $\beta_0$ к $0$. В этом случае все три коэффициента $u,v,c$ уравнения \eqref {u_v_omega_0} становятся малыми и преобразования, связанные с делением на них,  неустойчивы. Из приведенных в статье графиков среднеквадратичных погрешностей можно сделать следующий вывод: если $\beta_0$ имеет величину порядка $1^o,2^o$, то погрешность становится больше самой определяемой величины, т.е. вычисления с практической точки зрения бесполезны. Существенным оказывается и соотношение углов $\beta_0$ и $\beta_1$. С увеличением разности между ними растет и погрешность. Большая разность между этими углами возможна в том случае, когда объект пеленгации находится слишком близко к датчикам.

\begin{thebibliography}{4}

\bibitem {WGMNP} Виноградов А.Д., Грибанов В.В., Михин А.Ю., Никитенко Е.П., Подшивалова Г.В Способ и характеристики угломестного радиопеленгования с использованием эквидистантной трехэлементной антенной решетки из соосных вертикальных вибраторных антенн. // Антенны, выпуск  5 (237), 2017. -- С. 13--18.


\end{thebibliography}

\end{document}

